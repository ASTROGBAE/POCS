#!/usr/bin/env python3
import cmd
import readline

from panoptes import Panoptes


class PanShell(cmd.Cmd):
    """ A simple command loop for the sensors. """
    intro = 'Welcome to PanShell! Type ? for help'
    prompt = 'PanShell > '
    panoptes = None

    def do_connect(self, *arg):
        """ Create the unit and start up """
        self.panoptes = Panoptes()

    def do_get_ready(self, *arg):
        """ Start the unit """
        if self.panoptes is None:
            print("Run `connect` first")
            return False

        self.panoptes.get_ready()

    def do_status(self, *arg):
        """ Get the entire system status and print it pretty like! """
        # print("Status: ")
        pass

    def emptyline(self):
        pass

    def do_exit(self, *arg):
        """ Exits PanShell """
        print("Shutting down")

        print("Bye! Thanks!")
        return True


if __name__ == '__main__':
    import os
    import sys

    if not os.getenv('POCS'):
        sys.exit("Please set the POCS environment variable.")

    PanShell().cmdloop()
