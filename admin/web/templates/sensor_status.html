<div class="col-xs-4 placeholder">
	<div class="panel panel-info">
		<div class="panel-body">
			<div class="sensor_data">
			   <div id="weather_stats" style="width:420px;height:200px;"></div>
			</div>
		</div>
		<div class="panel-footer">
			<h3 class="panel-title">Sensors</h3>
		</div>
	</div>
</div>

{% block bottom %}
<script type="text/javascript">
        var graph_items = [
            'box_temp_01',
            'box_temp_02',
            'box_temp_03',
            'box_temp_04',
            'camera_head_temp',
       	];

        // Flot stuff
        var data = [], totalPoints = 60;

        // Initialize all data to zeros
        for (var i = 0; i < totalPoints; ++i) {
          item = {};

          for (var j = 0; j < graph_items.length; ++j)
            item[graph_items[j]] = 0;

          data.push(item);
        }

        function appendData(values) {
            if (data.length >= totalPoints)
              data = data.slice(1);

            data.push(values);
        }

        function convertValues(name) {
          var res = [];
          for (var i = 0; i < data.length; ++i)
          {
            res.push([i, data[i][name]]);
          }
          return res;
        }

        function prepareGraphData() {
          var res = [];

          for (var i in graph_items) {
            var name = graph_items[i];

            res.push({
              label: name,
              data: convertValues(name)
            });
          }

          return res;
        }

        function update_label(label, val){
        	$('#' + label).append(" " + val);
        }

        function plotStats(data) {
	      	temperature_data = {
	            'box_temp_01': data['/dev/arduino_0']['temp_00'],
	            'box_temp_02': data['/dev/arduino_0']['temp_01'],
	            'box_temp_03': data['/dev/arduino_0']['temp_02'],
	            'box_temp_04': data['/dev/arduino_0']['temp_03'],
	            'camera_head_temp': data['/dev/arduino_1']['temp_01'],
	    	};

	    	$.each(temperature_data, update_label);

	      	humidity_data = {
	            'box_humidity': data['/dev/arduino_0']['humidity'],
	            'camera_head_humidity': data['/dev/arduino_1']['humidity'],
	    	};

	      	accelerometer_data = {
	            'x': data['/dev/arduino_1']['humidity']['x'],
	            'y': data['/dev/arduino_1']['humidity']['y'],
	            'z': data['/dev/arduino_1']['humidity']['z'],
	            'o': data['/dev/arduino_1']['humidity']['o'],
	    	};

	      	voltage_data = {
	            'ac': data['/dev/arduino_0']['voltages']['ac'],
	            'dc': data['/dev/arduino_0']['voltages']['dc'],
	    	};

	      	fan_data = {
	            'fan': data['/dev/arduino_0']['fan'],
	    	};

 	       	appendData(temperature_data);

	        plot.setData(prepareGraphData());
	        plot.setupGrid();
	        plot.draw();
	    }

        var options = {
          series: {
              lines: {
                  show: true
              }
          },
          yaxis: {min: 0, },
          xaxis: {show: false },
			legend: {
			    position: "nw",
			    labelFormatter: function(label, series) {
 					// series is the series object for the label
    				return '<span id="' + label + '">' + label + '</span>';
				},
			}
        };

        var plot = $.plot('#weather_stats', prepareGraphData(), options);
</script>
{% end %}